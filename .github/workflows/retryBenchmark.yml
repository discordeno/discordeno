name: Benchmark with retry

on:
  pull_request:
  push:

jobs:
  benchmark-try-1:
    uses: ./.github/workflows/benchmark.yml

  benchmark-try-2:
    needs: benchmark-try-1
    if: ${{ always() && needs.benchmark-try-1.result == 'failure' }}
    uses: ./.github/workflows/benchmark.yml

  benchmark-try-3:
    needs: benchmark-try-2
    if: ${{ always() && needs.benchmark-try-2.result == 'failure' }}
    uses: ./.github/workflows/benchmark.yml

  benchmark-try-4:
    needs: benchmark-try-3
    if: ${{ always() && needs.benchmark-try-3.result == 'failure' }}
    uses: ./.github/workflows/benchmark.yml

  benchmark-try-5:
    needs: benchmark-try-4
    if: ${{ always() && needs.benchmark-try-4.result == 'failure' }}
    uses: ./.github/workflows/benchmark.yml

  benchmark-try-6:
    needs: benchmark-try-5
    if: ${{ always() && needs.benchmark-try-5.result == 'failure' }}
    uses: ./.github/workflows/benchmark.yml
