---
sidebar_position: 2
---
import BrowserOnly from '@docusaurus/BrowserOnly';

# Architecture
## Overview

import FlowChart from '@site/src/components/architecture/FlowChart'

<BrowserOnly>
  {() => <FlowChart />}
</BrowserOnly>

Discordeno have three main components/process, gateway, bot and rest. The Gateway process is responsible for handling and maintaining the websocket with discord, the websocket events from discord, such as connection, resuming, heartbeating and sending websocket message to discord. The Bot process is responsible for handling and converting all events from discord and trigger your code, like run function on message create. The Rest process is responsible for handling/fetching all http requests to discord, such as ratelimiting and proxying.

## Gateway Process
import FlowChart2 from '@site/src/components/architecture/FlowChart2'

<BrowserOnly>
  {() => <FlowChart2 />}
</BrowserOnly>

The Gateway process have two part the gateway manager and the gateway [shard](https://discord.com/developers/docs/topics/gateway#sharding), the gateway manager oversee the gateway shard.

### Gateway Manager

The gateway manager spawn the right amount of shard acording to data from discord's [getGatewayBot](https://discord.com/developers/docs/topics/gateway#get-gateway-bot) endpoint, user can override the value of gatewayBot by directly passing the value. The manager control the order or sequence of shard identifying base on the session start limit listed in the getGatewayBot to prevent hitting the ratelimiting. By default the manager will check the getGatewayBot endpoint every 8 hours and reshard if the number of shard changed shard. Check [here](/tutorial/big-bot-guide/gateway#understanding-gateway-manager) for more information about the gateway manager.

### Gateway Shard

The gateway shard create a websocket connect to discord, and pass any event to the handleMessage function. The handleMessage function will check the event and intercept/process websocket related event like hello, resume, heartbeat, ready, only pass real event to the bot. You may customize the handleMessage to you own case, but it is not recommand unless you know what youd doing, as it is vital for the connection. After the function processed the event, the function will pass the event to the Bot proceess either directly (in same process), with rest api, with message queue, or with other method depend on the user customiztion.

## Bot Process
import FlowChart3 from '@site/src/components/architecture/FlowChart3'

<BrowserOnly>
  {() => <FlowChart3 handlerFilter={(handler) => handler.startsWith('handleChannel')}/>}
</BrowserOnly>

A simplified version of function used inside of the bot process, showing only the handlers, transformers and event related to channel event

### Bot

The Bot process receive event from gateway and pass all the event to the handleDiscordPayload function. The handleDiscordPayload function will call raw event for all event, and route to three layer for process the event, the handler, transformers and event. The handler will transformer the data of event with transformers and call the event with the transformed data. The transformer will remove useless property, change the name, abstractify bitwise permission flags change transform the data to a javascript.   

## Rest Process

TBC